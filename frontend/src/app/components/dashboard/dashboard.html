<div class="dashboard" 
     [class.mobile]="isMobile"
     [class.tablet]="isTablet">
  
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1>💰 Finanztracker</h1>
      <p>Behalten Sie Ihre Finanzen im Blick</p>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Daten werden geladen...</p>
    </div>
  </div>

  <!-- Mobile Layout -->
  <div class="mobile-layout" *ngIf="isMobile && !isLoading">
    
    <!-- Summary Section - Zurück zum Original -->
    <div class="summary-section">
      <div class="summary-cards">
        <div class="summary-card balance" 
             [class.positive]="totalBalance >= 0" 
             [class.negative]="totalBalance < 0">
          <div class="card-header">
            <span class="icon">{{ totalBalance >= 0 ? '📈' : '📉' }}</span>
            <span class="label">Gesamtsaldo</span>
          </div>
          <div class="amount">{{ totalBalance.toFixed(2) }}€</div>
        </div>
        
        <div class="summary-card income">
          <div class="card-header">
            <span class="icon">💰</span>
            <span class="label">Gesamteinnahmen</span>
          </div>
          <div class="amount">{{ totalIncome.toFixed(2) }}€</div>
        </div>
        
        <div class="summary-card expense">
          <div class="card-header">
            <span class="icon">💸</span>
            <span class="label">Gesamtausgaben</span>
          </div>
          <div class="amount">{{ totalExpense.toFixed(2) }}€</div>
        </div>
      </div>
    </div>

    <!-- Chart Section mit Dropdown - Original beibehalten -->
    <div class="chart-section">
      <!-- Monats-Dropdown -->
      <div class="month-selector">
        <label for="month-select">📅 Monat auswählen:</label>
        <select 
          id="month-select"
          [(ngModel)]="selectedMonth" 
          (change)="onMonthChange()"
          class="month-dropdown">
          <option *ngFor="let month of availableMonths" [value]="month.key">
            {{ month.label }}
          </option>
        </select>
      </div>

      <!-- Monatliche Zusammenfassung -->
      <div class="monthly-summary" *ngIf="currentMonthlyData">
        <div class="summary-cards-mini">
          <div class="mini-card income">
            <span class="icon">💰</span>
            <div class="details">
              <span class="label">Einnahmen</span>
              <span class="amount">{{ currentMonthlyData.income.toFixed(2) }}€</span>
            </div>
          </div>
          
          <div class="mini-card expense">
            <span class="icon">💸</span>
            <div class="details">
              <span class="label">Ausgaben</span>
              <span class="amount">{{ currentMonthlyData.expense.toFixed(2) }}€</span>
            </div>
          </div>
          
          <div class="mini-card balance" 
               [class.positive]="currentMonthlyData.balance >= 0" 
               [class.negative]="currentMonthlyData.balance < 0">
            <span class="icon">{{ currentMonthlyData.balance >= 0 ? '📈' : '📉' }}</span>
            <div class="details">
              <span class="label">Saldo</span>
              <span class="amount">{{ currentMonthlyData.balance.toFixed(2) }}€</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Chart Container -->
      <div class="chart-container" *ngIf="chartData && chartData.length > 0">
        <ngx-charts-bar-vertical
          [results]="chartData"
          [view]="view"
          [scheme]="colorScheme"
          [xAxis]="true"
          [yAxis]="true"
          [legend]="false"
          [showXAxisLabel]="false"
          [showYAxisLabel]="false"
          [showDataLabel]="true"
          [gradient]="true"
          [barPadding]="20"
          [animations]="true"
          [roundDomains]="true"
          [yScaleMin]="0"
          [tooltipDisabled]="false"
          (select)="onChartSelect($event)">
        </ngx-charts-bar-vertical>
      </div>

      <!-- Fallback wenn keine Chart-Daten -->
      <div class="no-chart-data" *ngIf="!chartData || chartData.length === 0">
        <div class="empty-content">
          <div class="empty-icon">📊</div>
          <h3>Keine Daten</h3>
          <p>Für {{ selectedMonthLabel }} sind keine Transaktionen vorhanden</p>
        </div>
      </div>
    </div>

    <!-- Transaktionen für ausgewählten Monat -->
    <div class="mobile-transactions-section">
      <div class="section-header">
        <h2>💳 Transaktionen</h2>
        <div class="transaction-count">
          {{ currentMonthTransactions.length }}
        </div>
      </div>

      <div class="mobile-transactions-list" *ngIf="currentMonthTransactions.length > 0; else monthlyEmptyState">
        <div 
          *ngFor="let transaction of currentMonthTransactions; trackBy: trackByTransactionId"
          class="mobile-transaction-item"
          [class.income]="transaction.type === 'income'"
          [class.expense]="transaction.type === 'expense'">
          
          <div class="transaction-content">
            <div class="transaction-icon">
              {{ getCategoryIcon(transaction.categoryId) }}
            </div>
            
            <div class="transaction-details">
              <span class="description">{{ transaction.description }}</span>
              <span class="date">{{ transaction.date | date:'dd.MM.yyyy' }}</span>
            </div>
            
            <div class="transaction-amount">
              <span class="amount">
                {{ transaction.type === 'income' ? '+' : '-' }}{{ transaction.amount.toFixed(2) }}€
              </span>
            </div>
          </div>
          
          <div class="transaction-actions">
            <button 
              class="delete-btn"
              (click)="deleteTransaction(transaction.id!)"
              title="Löschen">
              🗑️
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State Template -->
    <ng-template #monthlyEmptyState>
      <div class="empty-state">
        <div class="empty-content">
          <div class="empty-icon">📅</div>
          <h3>Keine Transaktionen</h3>
          <p>Für {{ selectedMonthLabel }} wurden noch keine Transaktionen erfasst</p>
        </div>
      </div>
    </ng-template>
  </div>

  <!-- Desktop Fallback -->
  <div class="desktop-layout" *ngIf="!isMobile && !isLoading">
    <div class="desktop-content">
      <h2>Desktop-Version in Entwicklung</h2>
      <p>Diese App ist für die mobile Nutzung optimiert.</p>
    </div>
  </div>

  <!-- Transaction Form Modal -->
  <div class="mobile-modal" *ngIf="showTransactionForm" (click)="showTransactionForm = false">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>✏️ Neue Transaktion</h3>
        <button class="close-btn" (click)="showTransactionForm = false">✕</button>
      </div>
      <div class="modal-body">
        <app-transaction-form (transactionAdded)="onTransactionAdded()"></app-transaction-form>
      </div>
    </div>
  </div>

  <!-- Enhanced FAB - Original Button zurück -->
  <div class="mobile-fab" *ngIf="isMobile">
    <button 
      class="fab-button"
      (click)="toggleTransactionForm()"
      [attr.aria-label]="showTransactionForm ? 'Formular schließen' : 'Neue Transaktion hinzufügen'">
      <div class="fab-icon" [class.rotated]="showTransactionForm"></div>
    </button>
  </div>
</div>
