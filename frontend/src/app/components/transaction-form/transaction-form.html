<div class="transaction-form">
  <form (ngSubmit)="onSubmit()" #transactionForm="ngForm">
    
    <!-- Type Selection -->
    <div class="form-group type-selection">
      <div class="type-buttons">
        <button 
          type="button"
          class="type-btn"
          [class.active]="transaction.type === 'income'"
          (click)="onTypeChange('income')">
          <span class="icon">ðŸ’°</span>
          <span>Einnahme</span>
        </button>
        
        <button 
          type="button"
          class="type-btn"
          [class.active]="transaction.type === 'expense'"
          (click)="onTypeChange('expense')">
          <span class="icon">ðŸ’¸</span>
          <span>Ausgabe</span>
        </button>
      </div>
    </div>

    <!-- Category Selection -->
    <div class="form-group category-selection">
      <label>Kategorie</label>
      <div class="category-grid">
        <button 
          type="button"
          *ngFor="let category of getAvailableCategories()"
          class="category-btn"
          [class.active]="transaction.categoryId === category.id"
          (click)="transaction.categoryId = category.id">
          <span class="icon">{{ category.icon }}</span>
          <span class="name">{{ category.name }}</span>
        </button>
      </div>
    </div>

    <!-- Description -->
    <div class="form-group">
      <label for="description">Beschreibung</label>
      <input 
        type="text"
        id="description"
        name="description"
        [(ngModel)]="transaction.description"
        placeholder="z.B. Einkauf bei REWE, Monatsgehalt..."
        required
        class="form-input">
    </div>

    <!-- Amount -->
    <div class="form-group">
      <label for="amount">Betrag (â‚¬)</label>
      <input 
        type="number"
        id="amount"
        name="amount"
        [(ngModel)]="transaction.amount"
        placeholder="0.00"
        min="0"
        step="0.01"
        required
        class="form-input">
    </div>

    <!-- Date -->
    <div class="form-group">
      <label for="date">Datum</label>
      <input 
        type="date"
        id="date"
        name="date"
        [(ngModel)]="transaction.date"
        required
        class="form-input">
    </div>

    <!-- Recurring Transaction Section -->
    <div class="form-section">
      <div class="recurring-toggle">
        <label class="toggle-container">
          <input 
            type="checkbox" 
            [(ngModel)]="transaction.isRecurring"
            (change)="onRecurringToggle()"
            class="toggle-input"
            name="isRecurring">
          <span class="toggle-slider"></span>
          <span class="toggle-label">Wiederkehrende Transaktion</span>
        </label>
      </div>

      <!-- Recurring Interval Selection -->
      <div class="recurring-intervals" *ngIf="transaction.isRecurring">
        <div class="interval-grid">
          <button
            type="button"
            *ngFor="let interval of recurringIntervals"
            class="interval-button"
            [class.selected]="transaction.recurringInterval === interval.id"
            (click)="transaction.recurringInterval = interval.id">
            <span class="interval-icon">{{ interval.icon }}</span>
            <span class="interval-label">{{ interval.label }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- TemporÃ¤rer Debug-Code - fÃ¼ge das nach dem Toggle ein -->
    <div>
      <p>isRecurring: {{ transaction.isRecurring }}</p>
      <p>recurringIntervals length: {{ recurringIntervals.length }}</p>
      <pre>{{ recurringIntervals | json }}</pre>
    </div>

    <!-- Submit Button -->
    <button 
      type="submit"
      class="submit-btn"
      [disabled]="!transactionForm.valid || isSubmitting || !transaction.categoryId"
      [class.loading]="isSubmitting">
      <span *ngIf="!isSubmitting">
        {{ transaction.type === 'income' ? 'ðŸ’° Einnahme hinzufÃ¼gen' : 'ðŸ’¸ Ausgabe hinzufÃ¼gen' }}
      </span>
      <span *ngIf="isSubmitting">
        <span class="spinner"></span>
        Wird gespeichert...
      </span>
    </button>

  </form>
</div>
